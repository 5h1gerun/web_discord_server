{% extends "mobile/base_phone.html" %}
{% block title %}ãƒ›ãƒ¼ãƒ  | WDS Phone{% endblock %}

{% block content %}
<h2 class="h4 mb-3">ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰</h2>
<div id="uploadArea">
  <form id="uploadForm" class="mb-2" method="post" action="/upload" enctype="multipart/form-data" onsubmit="return false;">
    <input type="hidden" name="folder_id" value="{{ folder_id }}">
    <input type="hidden" name="csrf_token" value="{{ csrf_token }}">
    <input type="file" name="file" class="form-control mb-2" multiple required>
    <button type="button" id="uploadBtn" class="btn btn-primary w-100">ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰
      <span id="uploadSpinner" class="spinner-border spinner-border-sm ms-1" style="display:none;"></span>
    </button>
  </form>
  <form id="createFolderForm" method="post" action="/create_folder" class="mb-3">
    <input type="hidden" name="csrf_token" value="{{ csrf_token }}">
    <input type="hidden" name="parent_id" value="{{ folder_id }}">
    <div class="input-group">
      <input type="text" name="name" class="form-control" placeholder="æ–°ã—ã„ãƒ•ã‚©ãƒ«ãƒ€å" required>
      <button class="btn btn-outline-primary" type="submit">ä½œæˆ</button>
    </div>
  </form>
  <div id="subfolderList">
  {% if subfolders %}
  <div class="list-group mb-3">
    {% for f in subfolders %}
    <div class="list-group-item d-flex justify-content-between align-items-center">
      <a href="/mobile?folder={{ f.id }}" class="flex-grow-1 text-decoration-none">
        <i class="bi bi-folder-fill me-2"></i>{{ f.name }}
      </a>
      <form method="post" action="/delete_folder/{{ f.id }}" onsubmit="return confirm('å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ');">
        <input type="hidden" name="csrf_token" value="{{ csrf_token }}">
        <button type="submit" class="btn btn-sm btn-outline-danger">å‰Šé™¤</button>
      </form>
    </div>
    {% endfor %}
  </div>
  <form method="post" action="/delete_subfolders" class="mb-3" onsubmit="return confirm('æœ¬å½“ã«å…¨ã¦å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ');">
    <input type="hidden" name="csrf_token" value="{{ csrf_token }}">
    <input type="hidden" name="parent_id" value="{{ folder_id }}">
    <button class="btn btn-danger btn-sm w-100">ã‚µãƒ–ãƒ•ã‚©ãƒ«ãƒ€å…¨å‰Šé™¤</button>
  </form>
  {% endif %}
  </div>
  </div>
<div class="progress mt-2" id="uploadProgressWrap" style="height:4px;display:none;">
  <div id="uploadProgressBar" class="progress-bar bg-success" role="progressbar" style="width:0%" aria-valuemin="0" aria-valuemax="100"></div>
</div>

<h2 class="h4 mb-3">ãƒ•ã‚¡ã‚¤ãƒ«ä¸€è¦§</h2>
<div class="mb-2">
  <input type="text" id="fileSearch" class="form-control" placeholder="æ¤œç´¢...">
</div>
<div id="fileListContainer">
  {% include 'mobile/partials/file_cards.html' %}
</div>
<div class="mt-3">
  <a href="/shared" class="btn btn-outline-primary btn-sm w-100 mb-2">å…±æœ‰ãƒ•ã‚©ãƒ«ãƒ€ã¸</a>
  {% if gdrive_enabled %}
    {% if gdrive_authorized %}
    <a href="/gdrive_import" class="btn btn-outline-success btn-sm w-100">ğŸ”„ Google Drive å–ã‚Šè¾¼ã¿</a>
    {% else %}
    <a href="/gdrive_auth" class="btn btn-outline-warning btn-sm w-100">ğŸ”‘ Google Drive é€£æº</a>
    {% endif %}
  {% endif %}
</div>
{% endblock %}
